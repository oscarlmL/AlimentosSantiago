{% extends 'base.html' %}
{% block contenido %}
{% load static %}
{% load carro %}
{% load humanize %}

<div class="maincontent">
    <div class="container">
        <div class="row ">
            <div class="col">
                <div class="list-group list-group-horizontal">
                    <a class="list-group-item list-group-item-action" href="#">Delivery</a>
                    <a class="list-group-item list-group-item-action" href="#">Retiro en local</a>

                <form action="/pagar" method="post">
                    {% csrf_token %}

                    </div>
                    <div id="map"></div>
                    <br>
                    <div class="form-group">
                        <label for="">Tipo de entrega</label>
                        <select name="tipo_entrega" id="" class="form-control">
                            <option value="" selected>--- Seleccionar tipo de entrega ---</option>
                            <option value="Delivery">Delivery</option>
                            <option value="Retiro en local">Retiro en local</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="">Tiempo estimado para retiro en el local</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="flexRadioDefault" id="ahora_horario">
                            <label class="form-check-label" for="flexRadioDefault1">
                                Ahora mismo
                            </label>
                        </div>
                        <div class="form-check" data-toggle="modal" data-target="#cartModal">
                            <input class="form-check-input" type="radio" name="flexRadioDefault" id="">
                            <label class="form-check-label" for="flexRadioDefault2">
                                Programar
                            </label>
                        </div>
                        <div class="modal fade bd-example-modal-sm" id="cartModal" tabindex="-1" role="dialog"
                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-sm" role="document">
                                <div class="modal-content">
                                    <div class="modal-header border-bottom-0">
                                        <h5 class="modal-title" id="exampleModalLabel">
                                            Elige un horario
                                        </h5>
                                        <hr>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <input type="datetime-local" class="form-control" name="programar_horario_entrega" id="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="">Dirección</label>
                        <input type="text" class="form-control" placeholder="Tú dirección" name="direccion"
                            id="clientAddress">
                    </div>
                    <div class="form-group">
                        <label for="">Tipo Pago</label>
                        <select name="tipo_pago" id="" class="form-control">
                            <option value="" selected>--- Seleccionar tipo de pago ---</option>
                            {% for tipo_pago in tipo_pago %}
                            <option value="{{tipo_pago.id_pago}}">{{tipo_pago.tipo_pago}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="">Celular de contacto</label>
                        <input type="tel" class="form-control" name="celular_contacto" placeholder="" value="">
                    </div>
                    <div class="form-group">
                        <input type="submit" class="btn btn-primary btn-round btn-block" value="Pagar">
                    </div>
                </form>



                <!-- <div class="col">
                    <h1>Pasar para realizar el pedido</h1>
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuemin="0"
                            aria-valuemax="100"></div>
                    </div>

                    <form id="regiration_form" action="action.php" method="post">
                        <fieldset>
                            <h2>Paso 1: Tipo de entrega</h2>
                            <div class="form-group">
                                <label for="">Tipo de entrega</label>
                                <select name="tipo_entrega" id="tipo_entrega" class="form-control">
                                    <option value="" selected>--- Seleccionar tipo de entrega ---</option>
                                    <option value="Delivery">Delivery</option>
                                    <option value="Retiro en local">Retiro en local</option>
                                </select>
                            </div>
                            <input type="button" name="data[password]" class="next btn btn-info" value="Siguiente" />
                        </fieldset>
                        <fieldset>
                            <h2> Paso 2: Horario</h2>
                            <div class="form-group">
                                <label for="">Tiempo estimado para retiro en el local</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="flexRadioDefault"
                                        id="ahora_horario" checked>
                                    <label class="form-check-label" for="flexRadioDefault1">
                                        Ahora mismo
                                    </label>
                                </div>
                                <div class="form-check" data-toggle="modal" data-target="#cartModal">
                                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="">
                                    <label class="form-check-label" for="flexRadioDefault2">
                                        Programar
                                    </label>
                                </div>
                                <div class="modal fade bd-example-modal-sm" id="cartModal" tabindex="-1" role="dialog"
                                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-sm" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header border-bottom-0">
                                                <h5 class="modal-title" id="exampleModalLabel">
                                                    Elige un horario
                                                </h5>
                                                <hr>
                                                <button type="button" class="close" data-dismiss="modal"
                                                    aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="form-group">
                                                    <input type="datetime-local" class="form-control"
                                                        name="programar_horario_entrega" id="programar_horario_entrega">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <input type="button" name="previous" class="previous btn btn-default" value="Previo" />
                            <input type="button" name="next" class="next btn btn-info" value="Siguiente" />
                        </fieldset>
                        <fieldset>
                            <h2>Paso 3: Información de contacto</h2>
                            <div class="form-group">
                                <label for="">Dirección</label>
                                <input type="text" class="form-control" placeholder="Tú dirección" name="direccion"
                                    id="direccion_cliente">
                            </div>
                            <div class="form-group">
                                <label for="">Celular de contacto</label>
                                <input type="tel" class="form-control" name="celular_contacto" id="celular_contacto"
                                    placeholder="" value="">
                            </div>
                            <input type="button" name="previous" class="previous btn btn-default" value="Previo" />
                            <input type="button" name="next" class="next btn btn-info" value="Siguiente" />

                        </fieldset>

                        <fieldset>
                            <h2>Paso 4: Tipo de pago</h2>
                            <div class="form-group">
                                <label for="">Tipo Pago</label>
                                <select name="tipo_pago" id="tipo_pago" class="form-control">
                                    <option value="" selected>--- Seleccionar tipo de pago ---</option>
                                    {% for tipo_pago in tipo_pago %}
                                    <option value="{{tipo_pago.id_pago}}">{{tipo_pago.tipo_pago}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <input type="button" name="previous" class="previous btn btn-default" value="Previo" />

                            <input type="submit" name="submit" class="submit btn btn-success" value="Enviar"
                                id="submit_data" />
                        </fieldset>
                    </form>
                </div> -->

            </div>
            <div class="">
                <div class="col">
                    <div class="">
                        <h2 class="font-weight-bold">Tus platos</h2>
                        <hr>
                        {% for platos_en_carro in platos_en_carro %}
                        <ul class="list-group">
                            <li class="list-group">Cantidad {{platos_en_carro|carro_quantity:request.session.carro}}
                            </li>
                            <li class="list-group">{{platos_en_carro.nom_plato}}</li>
                            <li class="list-group">{{platos_en_carro.descripcion}}</li>
                            <li class="list-group">$ {{platos_en_carro.valor_plato | intcomma}}</li>
                            <hr>
                        </ul>
                        {% endfor %}
                        <hr>
                        <li class="list-group font-weight-bold" style="font-size: 22px;">TOTAL A PAGAR <span>$
                                {{platos|precio_total_carro:request.session.carro | intcomma}}</span></li>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDq9u7UgsFdaDmz2I9RWJoAq2Cwy-YJxmE&libraries=places&callback=initMap" async defer"></script>
<script>
function initMap() {
   var input = document.getElementById('clientAddress');
   var autocomplete = new google.maps.places.Autocomplete(input);
   autocomplete.addListener('place_changed', function() {
       var place = autocomplete.getPlace();
       document.getElementById('location-snap').
       innerHTML = place.formatted_address;  
       document.getElementById('lat-span').
       innerHTML = place.geometry.location.lat();
       document.getElementById('lon-span').
       innerHTML = place.geometry.location.lng();
   });
}
</script>




<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<script>
    $(document).ready(function () {
        var current = 1,
            current_step, next_step, steps;
        steps = $("fieldset").length;
        $(".next").click(function (e) {
            let first_input;
            switch (current) {
                case 1:
                    first_input = document.getElementById('tipo_entrega');
                    break;
                case 2:
                    first_input = document.getElementById('programar_horario_entrega');
                    break;
                case 3:
                    first_input = document.getElementById('direccion_cliente');
                    second_input = document.getElementById('celular_contacto');
                    break;
                case 4:
                    first_input = document.getElementById('tipo_pago');
                default:
                    break;
            }
            if (first_input.validity.valid) {
                current_step = $(this).parent();
                next_step = $(this).parent().next();
                next_step.show();
                current_step.hide();
                setProgressBar(++current);
            }
        });

        $(".previous").click(function () {
            current_step = $(this).parent();
            next_step = $(this).parent().prev();
            next_step.show();
            current_step.hide();
            setProgressBar(--current);
        });


        $('.submit').click(function (e) {
            const formulario = document.querySelector('form');
            e.preventDefault();
            if (formulario.reportValidity()) {
                formulario.requestSubmit();
            }
        });

        setProgressBar(current);
        // Change progress bar action
        function setProgressBar(curStep) {
            var percent = parseFloat(100 / steps) * curStep;
            percent = percent.toFixed();
            $(".progress-bar")
                .css("width", percent + "%")
                .html(percent + "%");
        }
    });
    // el evento
    $('.submit').click(function (e) {
        e.preventDefault();
        // el formulario
        const formulario = document.querySelector('form');

        if (formulario.reportValidity()) {
            formulario.requestSubmit();
        }
    });
</script>

<style>
    #regiration_form fieldset:not(:first-of-type) {
        display: none;
    } -->
</style>
{% endblock %}